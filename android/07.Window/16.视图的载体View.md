#### ç›®å½•ä»‹ç»
- 00.Viewç®€å•ä»‹ç»
- 01.Viewçš„ç”Ÿå‘½å‘¨æœŸ
- 02.ç”Ÿå‘½å‘¨æœŸä½œç”¨



### å¥½æ¶ˆæ¯
- åšå®¢ç¬”è®°å¤§æ±‡æ€»ã€16å¹´3æœˆåˆ°è‡³ä»Šã€‘ï¼ŒåŒ…æ‹¬JavaåŸºç¡€åŠæ·±å…¥çŸ¥è¯†ç‚¹ï¼ŒAndroidæŠ€æœ¯åšå®¢ï¼ŒPythonå­¦ä¹ ç¬”è®°ç­‰ç­‰ï¼Œè¿˜åŒ…æ‹¬å¹³æ—¶å¼€å‘ä¸­é‡åˆ°çš„bugæ±‡æ€»ï¼Œå½“ç„¶ä¹Ÿåœ¨å·¥ä½œä¹‹ä½™æ”¶é›†äº†å¤§é‡çš„é¢è¯•é¢˜ï¼Œé•¿æœŸæ›´æ–°ç»´æŠ¤å¹¶ä¸”ä¿®æ­£ï¼ŒæŒç»­å®Œå–„â€¦â€¦å¼€æºçš„æ–‡ä»¶æ˜¯markdownæ ¼å¼çš„ï¼åŒæ—¶ä¹Ÿå¼€æºäº†ç”Ÿæ´»åšå®¢ï¼Œä»12å¹´èµ·ï¼Œç§¯ç´¯å…±è®¡Nç¯‡[è¿‘100ä¸‡å­—ï¼Œé™†ç»­æ¬åˆ°ç½‘ä¸Š]ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œè°¢è°¢ï¼
- **é“¾æ¥åœ°å€ï¼šhttps://github.com/yangchong211/YCBlogs**
- å¦‚æœè§‰å¾—å¥½ï¼Œå¯ä»¥starä¸€ä¸‹ï¼Œè°¢è°¢ï¼å½“ç„¶ä¹Ÿæ¬¢è¿æå‡ºå»ºè®®ï¼Œä¸‡äº‹èµ·äºå¿½å¾®ï¼Œé‡å˜å¼•èµ·è´¨å˜ï¼




### 00.Viewç®€å•ä»‹ç»
- å…ˆçœ‹ä¸€æ®µä»‹ç»
    - This class represents the basic building block for user interface components. A Viewoccupies a rectangular area on the screen and is responsible for drawing and event handling.
- Viewæ˜¯å±å¹•ä¸Šçš„ä¸€å—çŸ©å½¢åŒºåŸŸï¼Œè´Ÿè´£ç•Œé¢çš„ç»˜åˆ¶ä¸è§¦æ‘¸äº‹ä»¶çš„å¤„ç†ï¼Œå®ƒæ˜¯ä¸€ç§ç•Œé¢å±‚æ§ä»¶çš„æŠ½è±¡ï¼Œæ‰€æœ‰çš„æ§ä»¶éƒ½ç»§æ‰¿è‡ªViewã€‚
    - Viewæ˜¯Androidæ˜¾ç¤ºæ¡†æ¶ä¸­è¾ƒä¸ºå¤æ‚çš„ä¸€ç¯ï¼Œé¦–å…ˆæ˜¯å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¼šéšç€Activityçš„ç”Ÿå‘½å‘¨æœŸè¿›è¡Œå˜åŒ–ï¼ŒæŒæ¡Viewçš„ç”Ÿå‘½å‘¨æœŸå¯¹æˆ‘ä»¬è‡ªå®šä¹‰Viewæœ‰ç€é‡è¦çš„æ„ä¹‰ã€‚å¦ä¸€ä¸ªæ–¹é¢Viewä»ViewRoot.performTraversals()å¼€å§‹ç»å†measureã€layoutã€drawä¸‰ä¸ªæµç¨‹æœ€ç»ˆæ˜¾ç¤ºåœ¨ç”¨æˆ·é¢å‰ï¼Œç”¨æˆ·åœ¨ç‚¹å‡»å±å¹•æ—¶ï¼Œç‚¹å‡»äº‹ä»¶éšç€Activityä¼ å…¥Windowï¼Œæœ€ç»ˆç”±ViewGroup/Viewè¿›è¡Œåˆ†å‘å¤„ç†ã€‚



### 01.Viewçš„ç”Ÿå‘½å‘¨æœŸ
- åœ¨Viewä¸­æœ‰è¯¸å¤šå›è°ƒæ–¹æ³•ï¼Œå®ƒä»¬åœ¨Viewçš„ä¸åŒç”Ÿå‘½å‘¨æœŸé˜¶æ®µè°ƒç”¨ï¼Œå¸¸ç”¨çš„æœ‰ä»¥ä¸‹æ–¹æ³•ã€‚å†™ä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰Viewæ¥è§‚å¯ŸViewä¸Activityçš„ç”Ÿå‘½å‘¨æœŸå˜åŒ–ã€‚
    ```java
    public class CustomView extends View {
    
        private static final String TAG = "View";
    
        public CustomView(Context context) {
            super(context);
            Log.d(TAG, "CustomView()");
        }
    
        public CustomView(Context context, @Nullable AttributeSet attrs) {
            super(context, attrs);
            Log.d(TAG, "CustomView()");
        }
    
        public CustomView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
            super(context, attrs, defStyleAttr);
            Log.d(TAG, "CustomView()");
        }
    
        /**
         * Viewåœ¨xmlæ–‡ä»¶é‡ŒåŠ è½½å®Œæˆæ—¶è°ƒç”¨
         */
        @Override
        protected void onFinishInflate() {
            super.onFinishInflate();
            Log.d(TAG, "View onFinishInflate()");
        }
    
        /**
         * æµ‹é‡ViewåŠå…¶å­Viewå¤§å°æ—¶è°ƒç”¨
         */
        @Override
        protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
            super.onMeasure(widthMeasureSpec, heightMeasureSpec);
            Log.d(TAG, "View onMeasure()");
        }
    
        /**
         * å¸ƒå±€ViewåŠå…¶å­Viewå¤§å°æ—¶è°ƒç”¨
         */
        @Override
        protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
            super.onLayout(changed, left, top, right, bottom);
            Log.d(TAG, "View onLayout() left = " + left + " top = " + top + " right = " + right + " bottom = " + bottom);
        }
    
        /**
         * Viewå¤§å°å‘ç”Ÿæ”¹å˜æ—¶è°ƒç”¨
         */
        @Override
        protected void onSizeChanged(int w, int h, int oldw, int oldh) {
            super.onSizeChanged(w, h, oldw, oldh);
            Log.d(TAG, "View onSizeChanged() w = " + w + " h = " + h + " oldw = " + oldw + " oldh = " + oldh);
        }
    
        /**
         * ç»˜åˆ¶ViewåŠå…¶å­Viewå¤§å°æ—¶è°ƒç”¨
         */
        @Override
        protected void onDraw(Canvas canvas) {
            super.onDraw(canvas);
            Log.d(TAG, "View onDraw()");
        }
    
        /**
         * ç‰©ç†æŒ‰é”®äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨
         */
        @Override
        public boolean onKeyDown(int keyCode, KeyEvent event) {
            Log.d(TAG, "View onKeyDown() event = " + event.getAction());
            return super.onKeyDown(keyCode, event);
        }
    
        /**
         * ç‰©ç†æŒ‰é”®äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨
         */
        @Override
        public boolean onKeyUp(int keyCode, KeyEvent event) {
            Log.d(TAG, "View onKeyUp() event = " + event.getAction());
            return super.onKeyUp(keyCode, event);
        }
    
        /**
         * è§¦æ‘¸äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨
         */
        @Override
        public boolean onTouchEvent(MotionEvent event) {
            Log.d(TAG, "View onTouchEvent() event =  " + event.getAction());
            return super.onTouchEvent(event);
        }
    
        /**
         * Viewè·å–ç„¦ç‚¹æˆ–è€…å¤±å»ç„¦ç‚¹æ—¶è°ƒç”¨
         */
        @Override
        protected void onFocusChanged(boolean gainFocus, int direction, @Nullable Rect previouslyFocusedRect) {
            super.onFocusChanged(gainFocus, direction, previouslyFocusedRect);
            Log.d(TAG, "View onFocusChanged() gainFocus = " + gainFocus);
        }
    
        /**
         * Viewæ‰€åœ¨çª—å£è·å–ç„¦ç‚¹æˆ–è€…å¤±å»ç„¦ç‚¹æ—¶è°ƒç”¨
         */
        @Override
        public void onWindowFocusChanged(boolean hasWindowFocus) {
            super.onWindowFocusChanged(hasWindowFocus);
            Log.d(TAG, "View onWindowFocusChanged() hasWindowFocus = " + hasWindowFocus);
        }
    
        /**
         * Viewè¢«å…³è”åˆ°çª—å£æ—¶è°ƒç”¨
         */
        @Override
        protected void onAttachedToWindow() {
            super.onAttachedToWindow();
            Log.d(TAG, "View onAttachedToWindow()");
        }
    
        /**
         * Viewä»çª—å£åˆ†ç¦»æ—¶è°ƒç”¨
         */
        @Override
        protected void onDetachedFromWindow() {
            super.onDetachedFromWindow();
            Log.d(TAG, "View onDetachedFromWindow()");
        }
    
        /**
         * Viewçš„å¯è§æ€§å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨
         */
        @Override
        protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
            super.onVisibilityChanged(changedView, visibility);
            Log.d(TAG, "View onVisibilityChanged() visibility = " + visibility);
        }
    
        /**
         * Viewæ‰€åœ¨çª—å£çš„å¯è§æ€§å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨
         */
        @Override
        protected void onWindowVisibilityChanged(int visibility) {
            super.onWindowVisibilityChanged(visibility);
            Log.d(TAG, "View onWindowVisibilityChanged() visibility = " + visibility);
        }
    }
    ```

#### 1.1 Activityä¸Viewçš„ç”Ÿå‘½å‘¨æœŸ
- Activity create
    ```
    2019-08-22 13:48:02.423 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: CustomView()
    2019-08-22 13:48:02.423 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onFinishInflate()
    2019-08-22 13:48:02.618 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onCreate
    2019-08-22 13:48:02.627 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onStart
    2019-08-22 13:48:02.630 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onResume
    2019-08-22 13:48:02.670 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onAttachedToWindow()
    2019-08-22 13:48:02.670 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onWindowVisibilityChanged() visibility = 0
    2019-08-22 13:48:02.670 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onVisibilityChanged() visibility = 0
    2019-08-22 13:48:02.687 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onMeasure()
    2019-08-22 13:48:02.709 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onMeasure()
    2019-08-22 13:48:02.713 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onSizeChanged() w = 1080 h = 30 oldw = 0 oldh = 0
    2019-08-22 13:48:02.714 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onLayout() left = 0 top = 0 right = 1080 bottom = 30
    2019-08-22 13:48:02.993 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onDraw()
    2019-08-22 13:48:03.058 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onWindowFocusChanged() hasWindowFocus = true
    ```
- Activity pause
    ```
    2019-08-22 13:50:02.843 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onPause
    2019-08-22 13:50:02.866 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onWindowFocusChanged() hasWindowFocus = false
    2019-08-22 13:50:03.343 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onWindowVisibilityChanged() visibility = 8
    2019-08-22 13:50:03.369 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onStop
    2019-08-22 13:50:03.375 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onVisibilityChanged() visibility = 4
    ```
- Activity resume
    ```
    2019-08-22 13:50:57.229 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onStart
    2019-08-22 13:50:57.232 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onResume
    2019-08-22 13:50:57.233 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onVisibilityChanged() visibility = 0
    2019-08-22 13:50:57.237 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onWindowVisibilityChanged() visibility = 0
    2019-08-22 13:50:57.277 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onDraw()
    2019-08-22 13:50:57.299 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onWindowFocusChanged() hasWindowFocus = true
    ```
- Activity destory
    ```
    2019-08-22 13:51:46.013 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onStop
    2019-08-22 13:51:46.014 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onVisibilityChanged() visibility = 4
    2019-08-22 13:51:46.019 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--Activity--: onDestroy
    2019-08-22 13:51:46.020 31303-31303/org.yczbj.ycrefreshview D/å°æ¨æµ‹è¯•--View--: View onDetachedFromWindow()
    ```
- æ¥æ€»ç»“ä¸€ä¸‹Viewçš„å£°æ˜å‘¨æœŸéšç€Activityç”Ÿå‘½å‘¨æœŸå˜åŒ–çš„æƒ…å†µã€‚
    - <img src="https://github.com/guoxiaoxing/android-open-source-project-analysis/raw/master/art/app/ui/view_lifecycle.png"/>


### 02.ç”Ÿå‘½å‘¨æœŸä½œç”¨
- äº†è§£è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼ŸğŸ¤”å…¶å®è¿™äº›æ–¹æ³•åœ¨æˆ‘ä»¬è‡ªå®šä¹‰Viewçš„æ—¶å€™å‘æŒ¥ç€å¾ˆå¤§çš„ä½œç”¨ï¼Œæˆ‘ä»¬æ¥ä¸¾å‡ ç§åº”ç”¨åœºæ™¯ã€‚
- åœºæ™¯1ï¼šåœ¨Activityå¯åŠ¨æ—¶è·å–Viewçš„å®½é«˜ï¼Œä½†æ˜¯åœ¨onCreateã€onStartå’ŒonResumeå‡æ— æ³•è·å–æ­£ç¡®çš„ç»“æœã€‚è¿™æ˜¯å› ä¸ºåœ¨Activityçš„è¿™äº›æ–¹æ³•é‡Œï¼ŒViewedç»˜åˆ¶å¯èƒ½è¿˜æ²¡æœ‰å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Viewçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•é‡Œè·å–ã€‚
    ``` java
    @Override
    public void onWindowFocusChanged(boolean hasFocus) {
        super.onWindowFocusChanged(hasFocus);
        if(hasFocus){
            int width = view.getMeasuredWidth();
            int height = view.getMeasuredHeight();
        }
    }
    ```
- åœºæ™¯2ï¼šåœ¨Activityç”Ÿå‘½å‘¨æœŸå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒViewä¹Ÿè¦åšå“åº”çš„å¤„ç†ï¼Œå…¸å‹çš„æœ‰VideoViewä¿å­˜è¿›åº¦å’Œæ¢å¤è¿›åº¦ã€‚
    ``` java
    @Override
    protected void onVisibilityChanged(@NonNull View changedView, int visibility) {
        super.onVisibilityChanged(changedView, visibility);
        //TODO do something if activity lifecycle changed if necessary
        //Activity onResume()
        if(visibility == VISIBLE){
            
        }
        //Activity onPause()
        else {
            
        }
    }
    
    @Override
    public void onWindowFocusChanged(boolean hasWindowFocus) {
        super.onWindowFocusChanged(hasWindowFocus);
    
        //TODO do something if activity lifecycle changed if necessary
        //Activity onResume()
        if (hasWindowFocus) {
        }
        //Activity onPause()
        else {
        }
    }
    ```
- åœºæ™¯3ï¼šé‡Šæ”¾çº¿ç¨‹ã€èµ„æº
    ``` java
    @Override
    protected void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        //TODO release resources, thread, animation
    }
    ```



### å…¶ä»–ä»‹ç»
#### 01.å…³äºåšå®¢æ±‡æ€»é“¾æ¥
- 1.[æŠ€æœ¯åšå®¢æ±‡æ€»](https://www.jianshu.com/p/614cb839182c)
- 2.[å¼€æºé¡¹ç›®æ±‡æ€»](https://blog.csdn.net/m0_37700275/article/details/80863574)
- 3.[ç”Ÿæ´»åšå®¢æ±‡æ€»](https://blog.csdn.net/m0_37700275/article/details/79832978)
- 4.[å–œé©¬æ‹‰é›…éŸ³é¢‘æ±‡æ€»](https://www.jianshu.com/p/f665de16d1eb)
- 5.[å…¶ä»–æ±‡æ€»](https://www.jianshu.com/p/53017c3fc75d)



#### 02.å…³äºæˆ‘çš„åšå®¢
- githubï¼šhttps://github.com/yangchong211
- çŸ¥ä¹ï¼šhttps://www.zhihu.com/people/yczbj/activities
- ç®€ä¹¦ï¼šhttp://www.jianshu.com/u/b7b2c6ed9284
- csdnï¼šhttp://my.csdn.net/m0_37700275
- å–œé©¬æ‹‰é›…å¬ä¹¦ï¼šhttp://www.ximalaya.com/zhubo/71989305/
- å¼€æºä¸­å›½ï¼šhttps://my.oschina.net/zbj1618/blog
- æ³¡åœ¨ç½‘ä¸Šçš„æ—¥å­ï¼šhttp://www.jcodecraeer.com/member/content_list.php?channelid=1
- é‚®ç®±ï¼šyangchong211@163.com
- é˜¿é‡Œäº‘åšå®¢ï¼šhttps://yq.aliyun.com/users/article?spm=5176.100- 239.headeruserinfo.3.dT4bcV
- segmentfaultå¤´æ¡ï¼šhttps://segmentfault.com/u/xiangjianyu/articles
- æ˜é‡‘ï¼šhttps://juejin.im/user/5939433efe88c2006afa0c6e






